<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./modal.css">
    <link rel="stylesheet" href="css/globals/index.css">
    <link rel="stylesheet" href="css/pages/index.css">
    <title>–ß–∏—Å—Ç—ã–π –î–æ–º | –ì–ª–∞–≤–Ω–∞—è</title>
</head>
<body>
    <div class="wrapper">
        <header class="header">
            <div class="header__container">
                <div class="header__logobox">
                <a href="index.html"><img class="header__logo" src="images/header/5880208.png"></a>
                <h2 class="header__title">–ß–∏—Å—Ç—ã–π –¥–æ–º</h2>
                </div>
                <nav class="header__menu menu">
                    <ul class="menu__list">
                        <li class="menu__item"><a href="index.html" class="menu__link">–ì–ª–∞–≤–Ω–∞—è</a></li>
                        <li class="menu__item"><a href="take_order.html" class="menu__link">–û—Å—Ç–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É</a></li>
                        <li class="menu__item"><a href="service.html" class="menu__link">–£—Å–ª—É–≥–∏</a></li>
                        <li class="menu__item"><a href="registration.html" class="menu__link">–í—Ö–æ–¥</a></li>
                    </ul>
                </nav>
            </div>
        </header>

        <main class="main">
            <section class="welcome">
                <div class="welcome__container">
                    <div class="welcome__inf">
                        <h2 class="welcome__sign">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –Ω–∞ —Å–∞–π—Ç –∫–ª–∏–Ω–∏–Ω–≥–æ–≤–æ–π –∫–æ–º–ø–∞–Ω–∏–∏ </h2>
                        <h1 class="welcome__title">–ß–∏—Å—Ç—ã–π –¥–æ–º</h1>
                        <p class="welcome__text">–ú—ã –∑–∞–±–æ—Ç–∏–º—Å—è –æ –≤–∞—à–µ–π —á–∏—Å—Ç–æ—Ç–µ!</p>
                    </div>
                    <div class="welcome__img">
                        <img class="img__main" src="images/welcome/sign.jpg" alt="sign">
                    </div>

                </div>
            </section>

            <section class="services">
                <h2 class="services__title">–ù–∞—à–∏ —É—Å–ª—É–≥–∏</h2>
                <div class="services__container">
                    <div class="services__block">
                        <div class="services__item">
                            <img src="images/services/flats.png" class="services__img" alt="flats">
                            <h3 class="services__itemtitle">–£–±–æ—Ä–∫–∞ –∫–≤–∞—Ä—Ç–∏—Ä</h3>
                            <p class="services__text">–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è —É–±–æ—Ä–∫–∞ –≤–∞—à–µ–≥–æ –¥–æ–º–∞ –¥–ª—è –∏–¥–µ–∞–ª—å–Ω–æ–π —á–∏—Å—Ç–æ—Ç—ã –∏ –∫–æ–º—Ñ–æ—Ä—Ç–∞.</p>
                        </div>
                        <div class="services__item">
                            <img src="images/services/office.png" class="services__img" alt="office">
                            <h3 class="services__itemtitle">–£–±–æ—Ä–∫–∞ –æ—Ñ–∏—Å–æ–≤</h3>
                            <p class="services__text">–ß–∏—Å—Ç–æ—Ç–∞ —Ä–∞–±–æ—á–µ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –¥–ª—è –≤–∞—à–µ–≥–æ –±–∏–∑–Ω–µ—Å–∞.</p>
                        </div>
                        <div class="services__item">
                            <img src="images/services/general.png" class="services__img" alt="general">
                            <h3 class="services__itemtitle">–ì–µ–Ω–µ—Ä–∞–ª—å–Ω–∞—è —É–±–æ—Ä–∫–∞</h3>
                            <p class="services__text">–î–µ—Ç–∞–ª—å–Ω–∞—è —É–±–æ—Ä–∫–∞ –≤—Å–µ—Ö —É–≥–æ–ª–∫–æ–≤ –≤–∞—à–µ–≥–æ –ø–æ–º–µ—â–µ–Ω–∏—è.</p>
                        </div>
                    </div>
                </div>
            </section>

            <section id="about">
                <div class="about__container">
                    <h2 class="about__title">–û –Ω–∞—Å</h2>
                    <p class="about__text">–ö–ª–∏–Ω–∏–Ω–≥–æ–≤–∞—è –∫–æ–º–ø–∞–Ω–∏—è "–ß–∏—Å—Ç—ã–π –î–æ–º" –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —É—Å–ª—É–≥–∏ —É–±–æ—Ä–∫–∏ –±–æ–ª–µ–µ 5 –ª–µ—Ç. –ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º —ç–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–∏ —á–∏—Å—Ç—ã–µ —Å—Ä–µ–¥—Å—Ç–≤–∞ –∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ, —á—Ç–æ–±—ã —Å–¥–µ–ª–∞—Ç—å –≤–∞—à –¥–æ–º –∏–ª–∏ –æ—Ñ–∏—Å –∏–¥–µ–∞–ª—å–Ω—ã–º–∏.</p>
                </div>
            </section>
        </main>

        <footer class="footer">
            <div class="footer__container">
                <section id="contact">
                    <div class="contact__container">
                        <h2 class="contact__title">–ö–æ–Ω—Ç–∞–∫—Ç—ã</h2>
                        <p class="contact__phone">–ü–æ–∑–≤–æ–Ω–∏—Ç–µ –Ω–∞–º: <a href="tel:+79001231231" class="contact__link">+7 (900) 123-12-31</a></p>
                        <p class="contact__email">–ù–∞–ø–∏—à–∏—Ç–µ –Ω–∞–º: <a href="mailto:info@—á–∏—Å—Ç—ã–π–¥–æ–º.—Ä—Ñ" class="contact__link">info@—á–∏—Å—Ç—ã–π–¥–æ–º.—Ä—Ñ</a></p>
                    </div>
                </section>

                <section class="rights">
                    <div class="rights__container">
                        <p class="rights__text">&copy; 2024 –ß–∏—Å—Ç—ã–π –î–æ–º. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
                    </div>
                </section>
            </div>
        </footer>
    </div>
    <div class="modal" id="authModal">
        <div class="modal-content">
            <span class="close-btn">&times;</span>

            <div class="login-header">
                <div class="icon">üîê</div>
                <h2 id="form-title">Log in to your account</h2>
                <p id="form-subtitle">Welcome back! Please enter your details.</p>
            </div>

            <form id="authForm">
                <div class="form-group">
                    <label>Email</label>
                    <input type="email" id="email" placeholder="Enter your email" required>
                </div>

                <div class="form-group">
                    <label>Password</label>
                    <input type="password" id="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
                </div>

                <div class="form-group" id="passwordConfirmGroup" style="display: none;"  >
                    <label>Password confirmation</label>
                    <input type="password" id="passwordConfirm" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
                </div>

                <div class="options">
                    <label><input type="checkbox" id="showPass"> Show password</label>
                    <a href="#">Forgot password</a>
                </div>

                <button type="submit" class="btn-confirm" id="mainBtn">Login</button>
                <button type="button" class="btn-cancel">Cancel</button>
            </form>

            <div class="switch">
                <span id="switchText">Don't have an account? <a id="switchLink">Register</a></span>
            </div>
        </div>
    </div>
    <script>
        const form = document.getElementById("authForm");
        const emailInput = document.getElementById("email");
        const passwordInput = document.getElementById("password");
        const showPass = document.getElementById("showPass");
        const passwordConfirmInput = document.getElementById("passwordConfirm");
        const passwordConfirmGroup = document.getElementById("passwordConfirmGroup");
        const formTitle = document.getElementById("form-title");
        const formSubtitle = document.getElementById("form-subtitle");
        const mainBtn = document.getElementById("mainBtn");
        const switchText = document.getElementById("switchText");
        const switchLink = document.getElementById("switchLink");

        showPass.addEventListener("change", () => {
            if(showPass.checked){
                passwordInput.type = "text"
                passwordConfirmInput.type = "text"
            } else{
                passwordInput.type = "password"
                passwordConfirmInput.type = "password"
            }
        })

        let isLogin = true;

        function setFormMode(loginMode) {
            isLogin = loginMode;
            if (isLogin) {
                formTitle.textContent = "Log in to your account";
                formSubtitle.textContent = "Welcome back! Please enter your details.";
                mainBtn.textContent = "Login";
                switchText.innerHTML = `Don't have an account? <a id="switchLink">Register</a>`;
                passwordConfirmGroup.style.display = "none";
            } else {
                formTitle.textContent = "Create an account";
                formSubtitle.textContent = "Please enter your details to register.";
                mainBtn.textContent = "Register";
                switchText.innerHTML = `Already have an account? <a id="switchLink">Login</a>`;
                passwordConfirmGroup.style.display = "flex";
            }
        }
        document.getElementById("switchLink").addEventListener("click", () => {
            setFormMode(!isLogin);
        });

        switchText.addEventListener("click", (e) => {
            if (e.target && e.target.id === "switchLink") {
                e.preventDefault();
                setFormMode(!isLogin);
            }
        });

        const params = new URLSearchParams(window.location.search);
        setFormMode(!params.has("register") ? true : false);


        function getUsers() {
            return JSON.parse(localStorage.getItem("users")) || [];
        }

        function saveUsers(users) {
            localStorage.setItem("users", JSON.stringify(users));
        }

        form.addEventListener("submit", (e) => {
            e.preventDefault();
            const email = emailInput.value.trim();
            const password = passwordInput.value.trim();
            let users = getUsers();
            const passwordConfirm = passwordConfirmInput.value.trim();      

            if (isLogin) {
                const user = users.find(u => u.email === email && u.password === password);
                if (user) {
                    alert("‚úÖ Login successful!");
                    window.location.href = "index.html";
                } else {
                    alert("‚ùå Incorrect email or password!");
                }
            } else {
                const exists = users.some(u => u.email === email);
                if (exists) {
                    alert("‚ö†Ô∏è User with this email already exists!");
                    return;
                } 

                if(!passwordConfirm){
                    alert("‚ö†Ô∏è Please confirm your password!")
                    return;
                }
                
                if(password !== passwordConfirm){
                    alert("Passwords don't match!");
                    return;
                } else {
                    users.push({ email, password });
                    saveUsers(users);
                    alert("üéâ Registration successful! Now you can log in.");
                    setFormMode(true);
                }
            }
        });
        const modal = document.getElementById("authModal");
        const closeBtn = document.querySelector(".close-btn");
        const cancelBtn = document.querySelector(".btn-cancel");

        // –û—Ç–∫—Ä—ã—Ç–∏–µ –ø–æ –∫–ª–∏–∫—É –Ω–∞ —Å—Å—ã–ª–∫—É "–í—Ö–æ–¥"
        document.querySelectorAll(".menu__link").forEach(link => {
            if (link.textContent.trim() === "–í—Ö–æ–¥") {
                link.addEventListener("click", (e) => {
                    e.preventDefault(); // –Ω–µ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –Ω–∞ –¥—Ä—É–≥—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
                    modal.style.display = "flex";
                });
            }
        });

        // –ó–∞–∫—Ä—ã—Ç–∏–µ (–∫—Ä–µ—Å—Ç–∏–∫ –∏ Cancel)
        closeBtn.addEventListener("click", () => modal.style.display = "none");
        cancelBtn.addEventListener("click", () => modal.style.display = "none");

        // –ö–ª–∏–∫ –≤–Ω–µ –æ–∫–Ω–∞ —Ç–æ–∂–µ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç
        window.addEventListener("click", (e) => {
            if (e.target === modal) {
                modal.style.display = "none";
            }
        });
    </script>
</body>
</html>
